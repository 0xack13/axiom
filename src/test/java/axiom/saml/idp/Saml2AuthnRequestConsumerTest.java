package axiom.saml.idp;

import junit.framework.TestCase;

import org.apache.axis.encoding.Base64;

public class Saml2AuthnRequestConsumerTest extends TestCase {
		
	public void testBase64AuthnRequestConsumption() throws Exception{
		final String authnRequestXmlBase64 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHNhbWxwOkF1dGhuUmVxdWVzdCBBc3NlcnRpb25Db25zdW1lclNlcnZpY2VVUkw9Imh0dHBzOi8vbG9naW4uc2FsZXNmb3JjZS5jb20iIERlc3RpbmF0aW9uPSJodHRwOi8vbG9jYWxob3N0OjkwOTAvYXhpb20vUmVxdWVzdFNhbWxSZXNwb25zZS5hY3Rpb24iIElEPSJfMnZ4QnM4MlRGaDJyZEpEUFVvWGx6bnkwZ050Wm9VVFUzZ01ycmVxcjd5dmRPd2IzM1VnbEVNY3hSdHllWnVkM1ZvUTFmaDNULlNzeWxXUzYxa1AyZGxvcG1LTllRZWJqRlZ1R0dCcmZaVW55c2hOQ3FwMUlrNjIzUlpxRjJHYVlwcVZuRThNYzd0RTYyZi44R3BlM2tqRzlBbjVta3guSjkwY3BjTUF1VllXMkZGa2FGcGpIOXNHWXZjcy5nMFE0RjN6akdiZjBpejZ0c0t0b2ptakhHTndDZ3BrdG92ZyIgSXNzdWVJbnN0YW50PSIyMDA5LTA3LTA1VDIyOjI2OjU4Ljg0MFoiIFByb3RvY29sQmluZGluZz0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmJpbmRpbmdzOkhUVFAtUE9TVCIgVmVyc2lvbj0iMi4wIiB4bWxuczpzYW1scD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIj48c2FtbDpJc3N1ZXIgeG1sbnM6c2FtbD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI+aHR0cHM6Ly9zYW1sLnNhbGVzZm9yY2UuY29tPC9zYW1sOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4KPGRzOlNpZ25lZEluZm8geG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPgo8ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiLz4KPGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMSIgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiLz4KPGRzOlJlZmVyZW5jZSBVUkk9IiNfMnZ4QnM4MlRGaDJyZEpEUFVvWGx6bnkwZ050Wm9VVFUzZ01ycmVxcjd5dmRPd2IzM1VnbEVNY3hSdHllWnVkM1ZvUTFmaDNULlNzeWxXUzYxa1AyZGxvcG1LTllRZWJqRlZ1R0dCcmZaVW55c2hOQ3FwMUlrNjIzUlpxRjJHYVlwcVZuRThNYzd0RTYyZi44R3BlM2tqRzlBbjVta3guSjkwY3BjTUF1VllXMkZGa2FGcGpIOXNHWXZjcy5nMFE0RjN6akdiZjBpejZ0c0t0b2ptakhHTndDZ3BrdG92ZyIgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPgo8ZHM6VHJhbnNmb3JtcyB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+CjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiLz4KPGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxlYzpJbmNsdXNpdmVOYW1lc3BhY2VzIFByZWZpeExpc3Q9ImRzIHNhbWwgc2FtbHAiIHhtbG5zOmVjPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48L2RzOlRyYW5zZm9ybT4KPC9kczpUcmFuc2Zvcm1zPgo8ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIi8+CjxkczpEaWdlc3RWYWx1ZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+VmxwQVRVTDJQZHBaYjV5OG9OL21QOVZLZ2ZnPTwvZHM6RGlnZXN0VmFsdWU+CjwvZHM6UmVmZXJlbmNlPgo8L2RzOlNpZ25lZEluZm8+CjxkczpTaWduYXR1cmVWYWx1ZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+ClIreCtiYVloMmhBRkNqaUt6Q1pRVFY2K0RUY044TEp6UEFYcVhWamRJR2ZpQzNGU2VhL3JmLzF6ZUxKTGNyWVh6R0ZpemNBYzhoQUgKaHhTdndBSk5lMld0ZTRYVHRqZHhzSTdOTVlidHBYNjJSWHByN1N0RVkyR0NMVFBIZkFEUjBERjhFendHWWdpam9Fa01mdUJUYnFXSgpONWU1Y0Zzdm1HNzZzeTMyWEU4PQo8L2RzOlNpZ25hdHVyZVZhbHVlPgo8ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlFU3pDQ0E3U2dBd0lCQWdJUWVMdEd2cVV3QXdJK0FiYUtKN0lGd3pBTkJna3Foa2lHOXcwQkFRVUZBRENCdWpFZk1CMEdBMVVFCkNoTVdWbVZ5YVZOcFoyNGdWSEoxYzNRZ1RtVjBkMjl5YXpFWE1CVUdBMVVFQ3hNT1ZtVnlhVk5wWjI0c0lFbHVZeTR4TXpBeEJnTlYKQkFzVEtsWmxjbWxUYVdkdUlFbHVkR1Z5Ym1GMGFXOXVZV3dnVTJWeWRtVnlJRU5CSUMwZ1EyeGhjM01nTXpGSk1FY0dBMVVFQ3hOQQpkM2QzTG5abGNtbHphV2R1TG1OdmJTOURVRk1nU1c1amIzSndMbUo1SUZKbFppNGdURWxCUWtsTVNWUlpJRXhVUkM0b1l5azVOeUJXClpYSnBVMmxuYmpBZUZ3MHdPVEF4TURZd01EQXdNREJhRncweE1UQXhNRGN5TXpVNU5UbGFNSUdPTVFzd0NRWURWUVFHRXdKVlV6RVQKTUJFR0ExVUVDQk1LUTJGc2FXWnZjbTVwWVRFV01CUUdBMVVFQnhRTlUyRnVJRVp5WVc1amFYTmpiekVkTUJzR0ExVUVDaFFVVTJGcwpaWE5tYjNKalpTNWpiMjBzSUVsdVl5NHhGREFTQmdOVkJBc1VDMEZ3Y0d4cFkyRjBhVzl1TVIwd0d3WURWUVFERkJSd2NtOTRlUzV6CllXeGxjMlp2Y21ObExtTnZiVENCbnpBTkJna3Foa2lHOXcwQkFRRUZBQU9CalFBd2dZa0NnWUVBektFbGx1SFFZbFVuRm0xNTZOd3UKcDl2cWtmOUR2bmhPSmMwOUdOWUtPZHo1UGtwSi9iRkx1TjJmcm1mSlRsdzZwaTRrbkUyZ2VOM2oyNmlBRkdJcHFna2ZXbUFpNWtuagpjSWJPdkhiTVhNZzFhcHVWeUs5am1iS3k0cElUWkNqNTZQdEg3cU1qbG13TitaRWNRUlZ5K3VyUkdKUmZCRXlFK2h0NUtyZXdobGNDCkF3RUFBYU9DQVhvd2dnRjJNQWtHQTFVZEV3UUNNQUF3Q3dZRFZSMFBCQVFEQWdXZ01FWUdBMVVkSHdRL01EMHdPNkE1b0RlR05XaDAKZEhBNkx5OWpjbXd1ZG1WeWFYTnBaMjR1WTI5dEwwTnNZWE56TTBsdWRHVnlibUYwYVc5dVlXeFRaWEoyWlhJdVkzSnNNRVFHQTFVZApJQVE5TURzd09RWUxZSVpJQVliNFJRRUhGd013S2pBb0JnZ3JCZ0VGQlFjQ0FSWWNhSFIwY0hNNkx5OTNkM2N1ZG1WeWFYTnBaMjR1ClkyOXRMM0p3WVRBb0JnTlZIU1VFSVRBZkJnbGdoa2dCaHZoQ0JBRUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakEwQmdnckJnRUYKQlFjQkFRUW9NQ1l3SkFZSUt3WUJCUVVITUFHR0dHaDBkSEE2THk5dlkzTndMblpsY21semFXZHVMbU52YlRCdUJnZ3JCZ0VGQlFjQgpEQVJpTUdDaFhxQmNNRm93V0RCV0ZnbHBiV0ZuWlM5bmFXWXdJVEFmTUFjR0JTc09Bd0lhQkJSTGE3a29sZ1lNdTlCU09Kc3ByRXNICml5RUZHREFtRmlSb2RIUndPaTh2Ykc5bmJ5NTJaWEpwYzJsbmJpNWpiMjB2ZG5Oc2IyZHZNUzVuYVdZd0RRWUpLb1pJaHZjTkFRRUYKQlFBRGdZRUFFRnB4eGxaS05wY0hNS3BKOGtSMjhBOE1PTm1adWpUU2luTWVERUJFUlM5Q0w2UXlLOHlJckZyMW9mZS9xYWZmRmd5Qwp6b1pzMU1JdHh5Yk90U3ZWVGxvWExLWitrNlhiMXBMVkFwaGJoYW9GZjRZVjh1K1huOTFnaW90L2g5Tk5rTVN1Nzh2N3RuUWVOZkpPClZNUUI0OTNBYUduYm9sSVlralRRMG5yVTZIRT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48L2RzOlNpZ25hdHVyZT48L3NhbWxwOkF1dGhuUmVxdWVzdD4=";
		
		String authnRequestXmlString = new String(Base64.decode(authnRequestXmlBase64));
		
		assertEquals("https://login.salesforce.com", Saml2AuthnRequestConsumer.parseAssertionConsumerServiceURL(authnRequestXmlString));
	}
	
}
